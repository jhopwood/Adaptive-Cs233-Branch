<!DOCTYPE html>

<html lang="en">
  <head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <title>An Expression!</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="A Digital Logic Problem Server">
    <meta name="author" content="Craig Zilles">
    {% block cssblock %}
    <link href="/css/bootstrap.css" rel="stylesheet">
    <link href="/css/bootstrap-responsive.css" rel="stylesheet">
    <link href="/css/problemserver.css" rel="stylesheet">
    {% endblock cssblock %}

    <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>

  <body class="no-left-right-padding">
  {% block youtubeblock %}{% endblock %}
  <div class="inline-div well", id="questionblock">
	{% block questionblock %}{% endblock %}
  </div>
  <!-- this sets up the buttons for dificulty selection -->
  <div class="inline-div well", id="difficultyblock">
	<span id="prof">Your proficiency is {{ proficiency }}</span>
	</br>
	<button class="btn btn-large" id="easy">easy</button>
	<button class="btn btn-large" id="medium">medium</button>
	<button class="btn btn-large" id="hard">hard</button>
  </div>
  </body>
  <!-- Placed at the end of the document so the pages load faster -->
  <script src="/js/jquery.js"></script>
  <script src="/js/bootstrap.js"></script>
  <script src="/js/problemserver.js"></script>
  {% block jsblock %}{% endblock %}
  <script type="text/javascript">
    function submission_url() {
      // If submit_url is defined, just return that (useful for backwards
      // compatibility).
      if(window.submit_url != undefined) return window.submit_url;
      // Build the submission URL
      var submit_url = location.pathname;
      {# Since this file is sent through the template engine, these variables #}
      {# will be set with the correct submit parameters #}
      var level = "{{ submit.level }}";
      var student = "{{ submit.magic }}";
      var problem_id = "{{ submit.problem_id }}";
      return submit_url + "?l="+level+"&student="+student+"&problem_id="+problem_id;
    }
	
		
	//this function takes care of what the easy button will do
	function easy() 
	{ 
		$.post(submission_url(), {type: "question request", button:0}, 
		function(rdata) {
			$('body').html(rdata);
			$("#difficultyblock").hide();
		});
	}
	//this function takes care of what the medium button will do
	function medium() 
	{ 
		$.post(submission_url(), {type: "question request", button:1}, 
		function(rdata) {
			$('body').html(rdata);
			$("#difficultyblock").hide();
		});
	}
	//this function takes care of what the hard button will do
	function hard() 
	{
		$.post(submission_url(), {type: "question request", button:2}, 
		function(rdata) {
			$('body').html(rdata);
			$("#difficultyblock").hide();
		});
	}
	
	//this binds functions to buttons
	$("#easy").on("click", easy);
	$("#medium").on("click", medium);
	$("#hard").on("click", hard);
	
	//this overwrite allows me to send additional information with a press of the submission button
	$("#submit").unbind('click');
	$("#submit").click(function () {
		if ($("#submit").hasClass("disabled")) { return; }
		var answer = get_answer();
		$.post(submission_url(), {answer: answer, button: {{- question.button -}} }, 
		function(rdata) {
		  json_rdata = JSON.parse(rdata)
		  $("#submit").unbind('click');
		  $("#submit").html('done')
		  $("#difficultyblock").show();
		  $("#submit").removeClass('btn-primary').addClass('disabled').prop("disabled", true);
		  $("#score").html("Score: " + ((json_rdata["score"] === 100.0) ? '<span style="color:lime">100%</span>' : '<span style="color:red">' + json_rdata["score"] + '%</span>'));
		  $("#prof").html("Your proficiency is "+ json_rdata["proficiency"])
		  correct(json_rdata);
		});
	});
  </script>
</html>
